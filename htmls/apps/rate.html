<!DOCTYPE html>
<html lang="en">
        
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Main</title>
    </head>
    <body>
        <div class="container">
            <h1>Rate Us!</h1>
            <h4>Help us improve by your precious review!<br>(this will be sent annonymously)</h4>
            <a href="https://lin.ee/qCe3jIb"><img src="/imgs/apps/rate/rate.png" alt="Rate us in LINE" height="100" border="0"></a>
            <br>
            <br>
            <a onclick="back();">Back to Menu</a>
            <!---<h2>良いところ</h2>
            <textarea name="good-points" id="good-points" cols="50" rows="5"></textarea>
            <h2>改善してほしいところ</h2>
            <textarea name="bad-points" id="bad-points" cols="50" rows="5"></textarea>
            <br>
            <button class="submit-button" onclick="submit();">Submit</button>
            <h3 hidden>Thank you for your rating!</h3>-->
        </div>
        <style>
            body{
                font-family: Arial;
                height: 100vh;
                background: rgb(0,156,161);
                background: linear-gradient(90deg, rgba(0,156,161,1) 0%, rgba(22,147,94,1) 74%, rgba(23,176,72,1) 100%);
            }
            .submit-button{
                margin-top: 10px;
                width: 100px;
                height: 30px;
            }
            .container {
                margin: 0;
                padding: 20px;
                position: absolute;
                top: 50%;
                left: 50%;
                -ms-transform: translate(-50%, -50%);
                transform: translate(-50%, -50%);
                background-color: rgb(22, 22, 22);
                border-radius: 10px;
                text-align: center;
                width: 350px;
            }
            a{
                color: dodgerblue;
                text-decoration: none;
            }
            a:hover{
                color: dodgerblue;
                text-decoration: underline;
            }
        </style>
        <script>
            const goodPointsField = document.querySelector("#good-points");
            const badPointsField = document.querySelector("#bad-points");

            let submitted = false;
            
            function submit(){
                if(submitted){
                    return;
                }
                fetch("/apps/rate/submitRating", {
                    method: "POST",
                    body: JSON.stringify({
                        goodPoints: goodPointsField.value,
                        badPoints: badPointsField.value
                    }),
                    headers:{
                        "Content-Type": "application/json"
                    }
                });
                document.querySelector("h3").hidden = false;
                submitted = true;
            }

            function back(){
                window.location.href = `/menu?token=${window.sessionStorage.token}`;
            }
            setInterval(()=>{
                fetch("/updateToken",{
                    method: "POST",
                    body:JSON.stringify({
                        token:window.sessionStorage.token,
                    }),
                    headers: {
                        "Content-Type": "application/json"
                    }
                });
            }, 20000);
            fetch("/updateToken",{
                method: "POST",
                body: JSON.stringify({
                    token: window.sessionStorage.token
                }),
                headers:{
                    "Content-Type": "application/json"
                }
            });
        </script>
    </body>
</html>